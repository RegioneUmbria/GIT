#--------------------------------------------------------------
# File di configurazione in cui sono indicato i valori dei soli
# parametri di contesto della catena jelly da passare alla 
# regola 
#------------------------------------------------------------
# Numero di parametri previsti in input
rengine.jchain.in.nof=32
#------------------------------------------------------------
# Le coppie chiavi/valore hanno come key lo stesso nome 
# indicato nello script jelly xml
#------------------------------------------------------------
rengine.jchain.in.1.key=SQL_DOCFA
rengine.jchain.in.1.value=select distinct da.*, DU.NR_PROG, DU.TIPO_OPERAZIONE, DU.INDIR_FLAG, DU.INDIR_CODICE, DU.INDIR_TOPONIMO, DU.INDIR_NCIV_UNO, DU.INDIR_NCIV_DUE, DU.INDIR_NCIV_TRE from (SELECT DISTINCT * FROM (SELECT ddc.fornitura, ddc.protocollo_registrazione, NVL (ddc.sezione, '-') sezione, ddc.foglio, ddc.numero, NVL (ddc.subalterno, '-') subalterno FROM docfa_dati_censuari ddc UNION SELECT du.fornitura, du.protocollo_reg, NVL (du.sezione, '-') sezione, du.foglio, du.numero,NVL (DECODE (TRIM (du.subalterno),'', NULL,du.subalterno),'-') subalterno FROM docfa_uiu du)) da LEFT JOIN docfa_uiu du ON (da.fornitura = du.fornitura AND da.protocollo_registrazione = du.protocollo_reg AND da.sezione = NVL(du.sezione, '-') AND da.foglio = du.foglio AND da.numero = du.numero AND da.subalterno = NVL (DECODE (TRIM (du.subalterno),'', NULL,du.subalterno),'-')) order by da.foglio, da.numero, da.subalterno
rengine.jchain.in.2.key=SQL_ICI_PRECEDENTE
rengine.jchain.in.2.value=select * from sit_t_ici_oggetto ici,(select ici.foglio, ici.numero, ici.sub, max(yea_den) yea_den from  sit_t_ici_oggetto ici where ici.foglio = ? AND ici.numero = ? AND LPAD(NVL(TRIM(ici.SUB),'0'),4,'0') = ? AND ICI.YEA_DEN <= to_char(TO_DATE (?, 'YYYYMMDD'),'YYYY') group by ici.foglio, ici.numero, ici.sub) ici_anno where ici_anno.yea_den = ici.yea_den and ici.foglio = ici_anno.foglio and ici.numero = ici_anno.numero and ici.sub = ici_anno.sub
rengine.jchain.in.3.key=SQL_DOCFA_SUCCESSIVO
rengine.jchain.in.3.value=select min(ddc_post.data_registrazione) DATA_DOCFA from docfa_dati_censuari ddc, docfa_dati_censuari ddc_post where DDC.FORNITURA = ? AND DDC.PROTOCOLLO_REGISTRAZIONE = ? AND DDC.DATA_REGISTRAZIONE = ? AND DDC.FOGLIO = ? AND DDC.NUMERO = ? AND NVL(DDC.SUBALTERNO,'-') = ? AND DDC.FOGLIO = ddc_post.foglio AND DDC.NUMERO = ddc_post.numero AND NVL(DDC.SUBALTERNO,'-') = NVL(ddc_post.subalterno,'-') AND to_char(TO_DATE (DDC.DATA_REGISTRAZIONE, 'YYYYMMDD'),'YYYY')  <  to_char(TO_DATE (ddc_post.DATA_REGISTRAZIONE, 'YYYYMMDD'),'YYYY') order by ddc_post.data_registrazione
rengine.jchain.in.4.key=SQL_ICI_SUCCESSIVO
rengine.jchain.in.4.value=select * from sit_t_ici_oggetto ici, (select ici.foglio, ici.numero, ici.sub, min(yea_den) yea_den from  sit_t_ici_oggetto ici where ici.FOGLIO \= ? and ici.numero \= ? and LPAD(NVL(TRIM(ici.SUB),'0'),4,'0') \= ? and ICI.YEA_DEN > to_char(TO_DATE (?, 'YYYYMMDD'),'YYYY') and ICI.YEA_DEN <\= to_char(TO_DATE (?, 'YYYYMMDD'),'YYYY') group by ici.foglio, ici.numero, ici.sub) ici_anno where ici_anno.yea_den \= ici.yea_den and ici.foglio \= ici_anno.foglio and ici.numero \= ici_anno.numero and ici.sub \= ici_anno.sub 
rengine.jchain.in.5.key=SQL_DOCFA_IN_ANNO
rengine.jchain.in.5.value=select count(protocollo_registrazione) docfa_in_anno from docfa_dati_censuari where foglio = ? and numero = ? and NVL(subalterno,'-') = ? and to_char(TO_DATE (data_registrazione, 'YYYYMMDD'),'YYYY') = to_char(TO_DATE (?, 'YYYYMMDD'),'YYYY')
rengine.jchain.in.6.key=SQL_CIVICI_UIU_CATASTO
rengine.jchain.in.6.value=SELECT DISTINCT CU.PKID_CIVI INDIR_CAT_IMMOBILE, C.CIVICO, S.* FROM SITICIVI_UIU CU, SITIUIU U, SITICIVI C, SITIDSTR S WHERE CU.PKID_UIU = U.PKID_UIU AND U.COD_NAZIONALE = ? AND U.FOGLIO = ? AND U.PARTICELLA = ? AND U.UNIMM = ? AND CU.PKID_CIVI = C.PKID_CIVI AND CU.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.PKID_STRA = S.PKID_STRA
rengine.jchain.in.7.key=SQL_INDICE_CIVICO_CatDocfa
rengine.jchain.in.7.value= select * from sit_civico_totale a , sit_civico_totale  b where a.fk_ente_sorgente = '9' and a.prog_es='3' and  b.fk_ente_sorgente = '4' and b.prog_es = '2' and a.fk_civico =b.fk_civico and a.id_dwh = ?  and b.id_dwh = ?  --INDIR_CAT_IMMOBILE
rengine.jchain.in.8.key=SQL_UIU_CATASTO
rengine.jchain.in.8.value=select * from sitiuiu uiu where uiu.foglio = ? and uiu.particella = ? and uiu.unimm = ? and TO_DATE (TO_CHAR(uiu.data_inizio_val, 'DD/MM/yyyy'),'DD/MM/yyyy') < TO_DATE(?,'yyyyMMdd') and TO_DATE (TO_CHAR(uiu.data_fine_val, 'DD/MM/yyyy'),'DD/MM/yyyy') >= TO_DATE(?,'yyyyMMdd')
rengine.jchain.in.9.key=SQL_TITOLARI_UIU_ANNO_DOCFA
rengine.jchain.in.9.value=select s.pkid, s.pk_cuaa, deco.description tipo_titolo, c.perc_poss, c.data_inizio data_inizio_possesso,c.data_fine data_fine_possesso, s.codi_fisc cod_fiscale,s.codi_piva piva, s.ragi_soci, s.nome, s.sesso, s.data_nasc, s.data_morte, s.comu_nasc, s.flag_pers_fisica from siticonduz_imm_all C, CONS_SOGG_TAB S , CONS_DECO_TAB DECO WHERE deco.tablename = 'CONS_ATTI_TAB' AND deco.fieldname = 'TIPO_DOCUMENTO' AND deco.code = c.tipo_documento AND COD_NAZIONALE = ? AND FOGLIO = ? AND PARTICELLA = ? AND UNIMM = ? AND S.PK_CUAA = C.PK_CUAA AND C.DATA_INIZIO <= TO_DATE('3112'||TO_CHAR(TO_DATE(?,'yyyyMMDD'),'YYYY'),'ddMMyyyy') AND C.DATA_FINE  >= TO_DATE('0101'||TO_CHAR(TO_DATE(?,'yyyyMMDD'),'YYYY'),'ddMMyyyy') AND s.data_fine = TO_DATE ('99991231', 'yyyyMMDD')
rengine.jchain.in.10.key=SQL_INDICE_TITOLARE_CatAnagrafe
rengine.jchain.in.10.value=select B.ID_DWH ID_ANA_PERS, P.ID_EXT ID_EXT_PERSONA  from sit_soggetto_totale a , sit_soggetto_totale  b, SIT_D_PERSONA P where a.fk_ente_sorgente = '4' and a.prog_es='3' and  b.fk_ente_sorgente = '1' and b.prog_es = '1' and a.fk_soggetto =b.fk_soggetto and a.id_dwh = ? AND P.DT_FINE_VAL IS NULL AND P.ID = B.ID_DWH
rengine.jchain.in.11.key=SQL_RESIDENZA_TITOLARE
rengine.jchain.in.11.value=SELECT C.ID AS ANA_CIVICO_RESIDENZA FROM SIT_D_PERSONA_CIVICO  PC, SIT_D_CIVICO C WHERE PC.ID_EXT_D_PERSONA = ? AND TO_DATE(?,'YYYYMMDD') BETWEEN NVL(PC.DT_INIZIO_DATO,TO_DATE('01-01-0001','DD-MM-YYYY'))  AND NVL(PC.DT_FINE_DATO,TO_DATE('31-12-9999','DD-MM-YYYY')) AND PC.ID_EXT_D_CIVICO = C.ID_EXT AND C.DT_FINE_VAL IS NULL
rengine.jchain.in.12.key=SQL_INDICE_RESIDENZA_CIVICO_CATASTO
rengine.jchain.in.12.value=select * from sit_civico_totale a , sit_civico_totale b where a.fk_ente_sorgente = '1' and a.prog_es='1' and  b.fk_ente_sorgente = '4' and b.prog_es = '2' and a.fk_civico =b.fk_civico and a.id_dwh = ? and b.id_dwh IN (SELECT CU.PKID_CIVI INDIR_CAT_IMMOBILE FROM SITICIVI_UIU CU, SITIUIU U, SITICIVI C, SITIDSTR S WHERE CU.PKID_UIU = U.PKID_UIU AND U.COD_NAZIONALE = ? AND U.FOGLIO = ? AND U.PARTICELLA = ? AND U.UNIMM = ? AND CU.PKID_CIVI = C.PKID_CIVI AND CU.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.PKID_STRA = S.PKID_STRA)
rengine.jchain.in.13.key=SQL_INDICE_RESIDENZA_CIVICO_DOCFA
rengine.jchain.in.13.value=select * from sit_civico_totale a , sit_civico_totale b where a.fk_ente_sorgente \= '1' and a.prog_es\='1' and  b.fk_ente_sorgente \= '9' and b.prog_es \= '3' and a.fk_civico \=b.fk_civico and a.id_dwh \= ? and b.id_dwh \= ? 
rengine.jchain.in.14.key=SQL_DOCFA_CONTEMPORANEI
rengine.jchain.in.14.value=select distinct count(ddc.protocollo_registrazione) docfa_contemporanei FROM docfa_dati_censuari ddc left join docfa_uiu du on (DDC.FORNITURA \= DU.FORNITURA and DDC.PROTOCOLLO_REGISTRAZIONE \= DU.PROTOCOLLO_REG and DDC.FOGLIO \= DU.FOGLIO and DDC.NUMERO \= DU.NUMERO and NVL(DDC.SUBALTERNO,'-') \= nvl(DECODE(TRIM(du.SUBALTERNO),'',NULL,du.SUBALTERNO),'-')) where ddc.foglio \= ? AND ddc.numero \= ? AND NVL(ddc.subalterno,'-') \= ? AND ddc.data_registrazione \= ? AND DU.TIPO_OPERAZIONE \= ? 
rengine.jchain.in.15.key = SQL_VERIFICA_CLASSAMENTO
rengine.jchain.in.15.value=SELECT classe_min FROM docfa_classi_min WHERE NVL (TO_NUMBER (zc), -1) = NVL (?, -1) AND TO_NUMBER (foglio) = ? AND categoria = ?
rengine.jchain.in.16.key=SQL_DOCFA_SUCC
rengine.jchain.in.16.value=SELECT COUNT (protocollo_registrazione) docfa_succ FROM docfa_dati_censuari WHERE foglio = ? AND numero = ? AND NVL (subalterno, '-') = ? AND TO_DATE (data_registrazione, 'YYYYMMDD') BETWEEN TO_DATE (?, 'YYYYMMDD') AND TO_DATE (?, 'YYYYMMDD')
rengine.jchain.in.17.key=SQL_DOCFA_DATI_CENSUARI
rengine.jchain.in.17.value= select identificativo_immobile,codice_amminstrativo, data_registrazione, zona, categoria, classe, rendita_euro, consistenza, toponimo,indirizzo, civico_1, civico_2, civico_3 from docfa_dati_censuari ddc where fornitura = ? AND protocollo_registrazione = ?  AND foglio = ? AND numero = ? AND NVL (ddc.subalterno, '-') = ?
rengine.jchain.in.18.key=SQL_DOCFA_DATI_GENERALI
rengine.jchain.in.18.value= select * from docfa_dati_generali where fornitura = ? AND protocollo_reg = ?
rengine.jchain.in.19.key=SQL_DOCFA_DATA_REGISTRAZIONE
rengine.jchain.in.19.value= select distinct data_registrazione from docfa_dati_censuari ddc where fornitura \= ? AND protocollo_registrazione \= ? 
rengine.jchain.in.20.key=SQL_DOCFA_DICHIARANTE
rengine.jchain.in.20.value= select distinct DIC_NOME, DIC_COGNOME, DIC_RES_INDIR, DIC_RES_NUMCIV, DIC_RES_COM, DIC_RES_CAP, DIC_RES_PROV  from docfa_dichiaranti  where FORNITURA = ? AND PROTOCOLLO_REG = ?
rengine.jchain.in.21.key=SQL_SOGG_ICI_PRECEDENTE_UIU
rengine.jchain.in.21.value=SELECT o.* FROM sit_soggetto_totale a, sit_soggetto_totale b, sit_t_ici_sogg s, sit_t_ici_contrib c, sit_t_ici_oggetto o WHERE a.fk_ente_sorgente = '4' AND a.prog_es = '3' AND a.id_dwh = ?  AND a.fk_soggetto = b.fk_soggetto AND b.fk_ente_sorgente = '2' AND b.prog_es = '1' AND S.ID = b.id_dwh AND O.ID_EXT = C.ID_EXT_OGG_ICI AND C.ID_EXT_SOGG = S.ID_EXT AND O.YEA_DEN <= TO_CHAR(TO_DATE(? ,'yyyyMMdd'),'yyyy') AND o.foglio = ? AND o.numero = ? AND LPAD(NVL(TRIM(o.SUB),'0'),4,'0') = ? ORDER BY O.YEA_DEN desc
rengine.jchain.in.22.key=SQL_SOGG_ICI_SUCCESSIVO_UIU
rengine.jchain.in.22.value=SELECT o.* FROM sit_soggetto_totale a, sit_soggetto_totale b, sit_t_ici_sogg s, sit_t_ici_contrib c, sit_t_ici_oggetto o WHERE a.fk_ente_sorgente = '4' AND a.prog_es = '3' AND a.id_dwh = ?  AND a.fk_soggetto = b.fk_soggetto AND b.fk_ente_sorgente = '2' AND b.prog_es = '1' AND S.ID = b.id_dwh AND O.ID_EXT = C.ID_EXT_OGG_ICI AND C.ID_EXT_SOGG = S.ID_EXT AND O.YEA_DEN > TO_CHAR(TO_DATE(? ,'yyyyMMdd'),'yyyy')  AND O.YEA_DEN <= to_char(TO_DATE (? , 'YYYYMMDD'),'YYYY') AND o.foglio = ? AND o.numero = ? AND LPAD(NVL(TRIM(o.SUB),'0'),4,'0') = ? ORDER BY O.YEA_DEN desc
rengine.jchain.in.23.key=SQL_SOGG_ICI_PRECEDENTE_UND
rengine.jchain.in.23.value=SELECT o.* FROM sit_soggetto_totale a, sit_soggetto_totale b, sit_t_ici_sogg s, sit_t_ici_contrib c, sit_t_ici_oggetto o WHERE a.fk_ente_sorgente \= '4' AND a.prog_es \= '3' AND a.id_dwh \= ?  AND a.fk_soggetto \= b.fk_soggetto AND b.fk_ente_sorgente \= '2' AND b.prog_es \= '1' AND S.ID \= b.id_dwh AND O.ID_EXT \= C.ID_EXT_OGG_ICI AND C.ID_EXT_SOGG \= S.ID_EXT AND O.YEA_DEN <\= TO_CHAR(TO_DATE(?,'yyyyMMdd'),'yyyy') AND (o.foglio is null OR o.foglio \= ? ) AND (o.numero is null OR o.numero \= ? ) AND (LPAD(NVL(TRIM(SUB),'0'),4,'0') \= '0000' OR LPAD(NVL(TRIM(SUB),'0'),4,'0') \= ? ) MINUS SELECT o.* FROM sit_t_ici_oggetto o WHERE o.foglio \= ? AND o.numero \= ? AND LPAD(NVL(TRIM(SUB),'0'),4,'0') \= ?  
rengine.jchain.in.24.key=SQL_SOGG_ICI_SUCCESSIVO_UND
rengine.jchain.in.24.value=SELECT o.* FROM sit_soggetto_totale a, sit_soggetto_totale b, sit_t_ici_sogg s, sit_t_ici_contrib c, sit_t_ici_oggetto o WHERE a.fk_ente_sorgente \= '4' AND a.prog_es \= '3' AND a.id_dwh \= ?  AND a.fk_soggetto \= b.fk_soggetto AND b.fk_ente_sorgente \= '2' AND b.prog_es \= '1' AND S.ID \= b.id_dwh AND O.ID_EXT \= C.ID_EXT_OGG_ICI AND C.ID_EXT_SOGG \= S.ID_EXT AND O.YEA_DEN > TO_CHAR(TO_DATE(?,'yyyyMMdd'),'yyyy')  AND O.YEA_DEN <\= to_char(TO_DATE (?, 'YYYYMMDD'),'YYYY')  AND (o.foglio is null OR o.foglio \= ? ) AND (o.numero is null OR o.numero \= ? ) AND (LPAD(NVL(TRIM(SUB),'0'),4,'0') \= '0000' OR LPAD(NVL(TRIM(SUB),'0'),4,'0') \= ? ) MINUS SELECT o.* FROM sit_t_ici_oggetto o WHERE o.foglio \= ? AND o.numero \= ? AND LPAD(NVL(TRIM(SUB),'0'),4,'0') \= ?  
rengine.jchain.in.25.key=SQL_SOGG_ICI_PRECEDENTE_CIV
rengine.jchain.in.25.value=SELECT DISTINCT icio.*, iciv.ID || '|' || NVL(icio.NUM_CIV, '') || '|' || NVL(icio.ESP_CIV, '') AS ID_DWH, iciv.ID_EXT ID_STORICO, icio.NUM_CIV AS CIV_LIV1, icio.ESP_CIV AS CIV_LIV2, NULL AS CIV_LIV3, iciv.ID AS ID_ORIG_VIA, iciv.PREFISSO AS VIASEDIME, iciv.DESCRIZIONE INDIRIZZO, iciv.DT_FINE_VAL, iciv.ID_ORIG AS CODICE_CIVICO FROM (SELECT o.* FROM sit_soggetto_totale aso, sit_soggetto_totale bso, sit_t_ici_sogg s, sit_t_ici_contrib c, sit_t_ici_oggetto o WHERE aso.fk_ente_sorgente = '4' AND aso.prog_es = '3' AND aso.id_dwh = ?  AND aso.fk_soggetto = bso.fk_soggetto AND bso.fk_ente_sorgente = '2' AND bso.prog_es = '1' AND S.ID = bso.id_dwh AND O.ID_EXT = C.ID_EXT_OGG_ICI AND C.ID_EXT_SOGG = S.ID_EXT AND O.YEA_DEN <= TO_CHAR(TO_DATE(? ,'yyyyMMdd'),'yyyy')) icio INNER JOIN SIT_T_ICI_VIA iciv ON (icio.ID_EXT_VIA = iciv.ID_EXT ) WHERE iciv.ID || '|' || NVL(icio.NUM_CIV, '') || '|' || NVL(icio.ESP_CIV, '') IN (SELECT bc.id_dwh FROM sit_civico_totale ac, sit_civico_totale bc WHERE ac.fk_ente_sorgente = '9' AND ac.prog_es = '3'  AND Ac.FK_CIVICO = Bc.FK_CIVICO AND bc.fk_ente_sorgente = '2' AND bc.prog_es = '2' AND ac.id_dwh = ?)
rengine.jchain.in.26.key=SQL_SOGG_ICI_SUCCESSIVO_CIV
rengine.jchain.in.26.value=SELECT DISTINCT icio.*, iciv.ID || '|' || NVL(icio.NUM_CIV, '') || '|' || NVL(icio.ESP_CIV, '') AS ID_DWH, iciv.ID_EXT ID_STORICO, icio.NUM_CIV AS CIV_LIV1, icio.ESP_CIV AS CIV_LIV2, NULL AS CIV_LIV3, iciv.ID AS ID_ORIG_VIA, iciv.PREFISSO AS VIASEDIME, iciv.DESCRIZIONE INDIRIZZO, iciv.DT_FINE_VAL, iciv.ID_ORIG AS CODICE_CIVICO FROM (SELECT o.* FROM sit_soggetto_totale aso, sit_soggetto_totale bso, sit_t_ici_sogg s, sit_t_ici_contrib c, sit_t_ici_oggetto o WHERE aso.fk_ente_sorgente = '4' AND aso.prog_es = '3' AND aso.id_dwh = ?  AND aso.fk_soggetto = bso.fk_soggetto AND bso.fk_ente_sorgente = '2' AND bso.prog_es = '1' AND S.ID = bso.id_dwh AND O.ID_EXT = C.ID_EXT_OGG_ICI AND C.ID_EXT_SOGG = S.ID_EXT  AND O.YEA_DEN > TO_CHAR(TO_DATE(?,'yyyyMMdd'),'yyyy') AND O.YEA_DEN <= to_char(TO_DATE (?, 'YYYYMMDD'),'YYYY')) icio INNER JOIN SIT_T_ICI_VIA iciv ON (icio.ID_EXT_VIA = iciv.ID_EXT ) WHERE iciv.ID || '|' || NVL(icio.NUM_CIV, '') || '|' || NVL(icio.ESP_CIV, '') IN (SELECT bc.id_dwh FROM sit_civico_totale ac, sit_civico_totale bc WHERE ac.fk_ente_sorgente = '9' AND ac.prog_es = '3'  AND Ac.FK_CIVICO = Bc.FK_CIVICO AND bc.fk_ente_sorgente = '2' AND bc.prog_es = '2' AND ac.id_dwh = ?)
rengine.jchain.in.27.key=SQL_FAMILIARI_DATA_DOCFA
rengine.jchain.in.27.value=SELECT DISTINCT P2.* FROM SIT_D_PERS_FAM pf2, SIT_D_PERSONA p2,(SELECT  DISTINCT pf1.id_ext_d_famiglia FROM SIT_D_PERSONA p1, SIT_D_PERS_FAM PF1 WHERE p1.ID_EXT IN (select P.ID_EXT ID_EXT_PERSONA  from sit_soggetto_totale a , sit_soggetto_totale  b, SIT_D_PERSONA P where a.fk_ente_sorgente \= '4' and a.prog_es\='3' and  b.fk_ente_sorgente \= '1' and b.prog_es \= '1' and a.fk_soggetto \=b.fk_soggetto and a.id_dwh \= ? AND P.DT_FINE_VAL IS NULL AND P.ID \= B.ID_DWH) AND pf1.ID_EXT_D_PERSONA \= p1.id_ext AND TO_DATE(? ,'YYYYMMDD') BETWEEN  NVL(p1.dt_inizio_dato,TO_DATE('01/01/1000','DD/MM/YYYY')) AND NVL(p1.dt_fine_dato,sysdate) AND TO_DATE(? ,'YYYYMMDD') BETWEEN  NVL(PF1.dt_inizio_dato,TO_DATE('01/01/1000','DD/MM/YYYY')) AND NVL(PF1.dt_fine_dato,sysdate)) fam WHERE  pf2.id_ext_d_famiglia \= fam.id_ext_d_famiglia AND pf2.ID_EXT_D_PERSONA \= p2.ID_EXT AND P2.ID_EXT NOT IN (select P.ID_EXT ID_EXT_PERSONA from sit_soggetto_totale a , sit_soggetto_totale  b, SIT_D_PERSONA P where a.fk_ente_sorgente \= '4' and a.prog_es\='3' and  b.fk_ente_sorgente \= '1' and b.prog_es \= '1' and a.fk_soggetto \=b.fk_soggetto and a.id_dwh \= ? AND P.DT_FINE_VAL IS NULL AND P.ID \= B.ID_DWH) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(pf2.dt_inizio_dato,TO_DATE('10000101','YYYYMMDD')) AND NVL(pf2.dt_fine_dato,sysdate) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(p2.dt_inizio_dato,TO_DATE('10000101','YYYYMMDD')) AND NVL(p2.dt_fine_dato,sysdate) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(P2.DATA_IMM,TO_DATE('10000101','YYYYMMDD')) AND NVL(P2.DATA_EMI,sysdate) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(P2.DATA_NASCITA,TO_DATE('10000101','YYYYMMDD')) AND NVL(P2.DATA_MOR,sysdate) AND TO_DATE (?, 'YYYYMMDD') >\= NVL(P2.DATA_INIZIO_RESIDENZA,TO_DATE('10000101','YYYYMMDD')) 
rengine.jchain.in.28.key=SQL_UIU_CATASTO_POST
rengine.jchain.in.28.value=SELECT * FROM SITIUIU WHERE foglio = ? AND particella = ? AND unimm = ? AND data_Inizio_Val >=  TO_DATE(?,'yyyyMMdd') AND data_Fine_Val >  TO_DATE(?,'yyyyMMdd') ORDER BY data_Inizio_Val, data_Fine_Val
rengine.jchain.in.29.key=SQL_DOCFA_ICI_REPORT
rengine.jchain.in.29.value=SELECT DISTINCT fornitura, protocollo_docfa FROM DOCFA_ICI_REPORT ORDER BY fornitura, protocollo_docfa
rengine.jchain.in.30.key=SQL_DOCFA_ICI_REPORT_SUM_PRE
rengine.jchain.in.30.value=SELECT SUM(IMPONIBILE_UIU_PRE) SUM_IMPONIBILE_PRE FROM DOCFA_ICI_REPORT WHERE (TIPO_OPER_DOCFA IS NULL OR TIPO_OPER_DOCFA = 'V' OR TIPO_OPER_DOCFA='S') AND FORNITURA=? AND PROTOCOLLO_DOCFA=? 
rengine.jchain.in.31.key=SQL_DOCFA_ICI_REPORT_SUM_POST
rengine.jchain.in.31.value=SELECT SUM(IMPONIBILE_UIU_POST) SUM_IMPONIBILE_POST FROM DOCFA_ICI_REPORT WHERE (TIPO_OPER_DOCFA IS NULL OR TIPO_OPER_DOCFA = 'V' OR TIPO_OPER_DOCFA='C') AND FORNITURA=? AND PROTOCOLLO_DOCFA=?
rengine.jchain.in.32.key=SQL_UPDATE_SUM_IMPONIBILE
rengine.jchain.in.32.value=UPDATE DOCFA_ICI_REPORT SET SUM_IMPONIBILE_PRE = ? , SUM_IMPONIBILE_POST = ? , VAR_PERC_SUM_IMPONIBILE = ? WHERE FORNITURA=? AND PROTOCOLLO_DOCFA=? 