#--------------------------------------------------------------
# File di configurazione in cui sono indicato i valori dei soli
# parametri di contesto della catena jelly da passare alla 
# regola 
#------------------------------------------------------------
# Numero di parametri previsti in input
rengine.jchain.in.nof=27
#------------------------------------------------------------
# Le coppie chiavi/valore hanno come key lo stesso nome 
# indicato nello script jelly xml
#------------------------------------------------------------
rengine.jchain.in.1.key=SQL_DOCFA
rengine.jchain.in.1.value=select distinct da.*, DU.NR_PROG, DU.TIPO_OPERAZIONE, DU.INDIR_FLAG, DU.INDIR_CODICE, DU.INDIR_TOPONIMO, DU.INDIR_NCIV_UNO, DU.INDIR_NCIV_DUE, DU.INDIR_NCIV_TRE from (SELECT DISTINCT * FROM (SELECT ddc.fornitura, ddc.protocollo_registrazione, NVL (ddc.sezione, '-') sezione, ddc.foglio, ddc.numero, NVL (ddc.subalterno, '-') subalterno FROM docfa_dati_censuari ddc UNION SELECT du.fornitura, du.protocollo_reg, NVL (du.sezione, '-') sezione, du.foglio, du.numero,NVL (DECODE (TRIM (du.subalterno),'', NULL,du.subalterno),'-') subalterno FROM docfa_uiu du)) da LEFT JOIN docfa_uiu du ON (da.fornitura = du.fornitura AND da.protocollo_registrazione = du.protocollo_reg AND da.sezione = NVL(du.sezione, '-') AND da.foglio = du.foglio AND da.numero = du.numero AND da.subalterno = NVL (DECODE (TRIM (du.subalterno),'', NULL,du.subalterno),'-')) order by da.foglio, da.numero, da.subalterno
rengine.jchain.in.2.key=SQL_TARSU_PRECEDENTE
rengine.jchain.in.2.value=SELECT DISTINCT * FROM sit_t_tar_oggetto WHERE foglio = ? AND numero = ? AND LPAD (NVL(sub,'0'), 4, '0') = ?  AND dat_ini = (SELECT DISTINCT MAX(dat_ini) from (SELECT DISTINCT * FROM sit_t_tar_oggetto WHERE foglio = ? AND numero = ? AND LPAD (NVL (sub, '0'), 4, '0') = ? AND dat_ini < TO_DATE (?, 'YYYYMMDD'))) ORDER BY dat_ini desc, dat_fin desc
rengine.jchain.in.3.key=SQL_DOCFA_SUCCESSIVO
rengine.jchain.in.3.value=select min(ddc_post.data_registrazione) DATA_DOCFA from docfa_dati_censuari ddc, docfa_dati_censuari ddc_post where DDC.FORNITURA = ? AND DDC.PROTOCOLLO_REGISTRAZIONE = ? AND DDC.DATA_REGISTRAZIONE = ?  AND DDC.FOGLIO = ? AND DDC.NUMERO = ? AND NVL(DDC.SUBALTERNO,'-') = ? AND DDC.FOGLIO = ddc_post.foglio AND DDC.NUMERO = ddc_post.numero AND NVL(DDC.SUBALTERNO,'-') = NVL(ddc_post.subalterno,'-') AND to_char(TO_DATE (DDC.DATA_REGISTRAZIONE, 'YYYYMMDD'),'YYYY')  <  to_char(TO_DATE (ddc_post.DATA_REGISTRAZIONE, 'YYYYMMDD'),'YYYY') order by ddc_post.data_registrazione
rengine.jchain.in.4.key=SQL_TARSU_SUCCESSIVO
rengine.jchain.in.4.value=SELECT DISTINCT * FROM sit_t_tar_oggetto WHERE foglio = ? AND numero = ? AND LPAD (NVL (sub, '0'), 4, '0') = ? AND dat_ini = (SELECT DISTINCT MIN(dat_ini) from (SELECT DISTINCT * FROM sit_t_tar_oggetto WHERE foglio = ? AND numero = ? AND LPAD (NVL (sub, '0'), 4, '0') = ? AND dat_ini >= TO_DATE (?, 'YYYYMMDD') AND dat_ini < TO_DATE (?, 'YYYYMMDD'))) ORDER BY dat_ini, dat_fin
rengine.jchain.in.5.key=SQL_DOCFA_IN_ANNO
rengine.jchain.in.5.value=select count(protocollo_registrazione) docfa_in_anno from docfa_dati_censuari where foglio = ? and numero = ? and NVL(subalterno,'-') = ? and to_char(TO_DATE (data_registrazione, 'YYYYMMDD'),'YYYY') = to_char(TO_DATE (?, 'YYYYMMDD'),'YYYY')
rengine.jchain.in.6.key=SQL_CIVICI_UIU_CATASTO
rengine.jchain.in.6.value=SELECT DISTINCT CU.PKID_CIVI INDIR_CAT_IMMOBILE, C.CIVICO, S.* FROM SITICIVI_UIU CU, SITIUIU U, SITICIVI C, SITIDSTR S WHERE CU.PKID_UIU = U.PKID_UIU AND U.COD_NAZIONALE = ? AND U.FOGLIO = ? AND U.PARTICELLA = ? AND U.UNIMM = ? AND CU.PKID_CIVI = C.PKID_CIVI AND CU.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.PKID_STRA = S.PKID_STRA
rengine.jchain.in.7.key=SQL_INDICE_CIVICO_CatDocfa
rengine.jchain.in.7.value= select * from sit_civico_totale a , sit_civico_totale  b where a.fk_ente_sorgente = '9' and a.prog_es='3' and  b.fk_ente_sorgente = '4' and b.prog_es = '2' and a.fk_civico =b.fk_civico and a.id_dwh = ?  and b.id_dwh = ?  --INDIR_CAT_IMMOBILE
rengine.jchain.in.8.key=SQL_UIU_CATASTO
rengine.jchain.in.8.value=select * from sitiuiu uiu where uiu.foglio = ? and uiu.particella = ? and uiu.unimm = ? and TO_DATE (TO_CHAR(uiu.data_inizio_val, 'DD/MM/yyyy'),'DD/MM/yyyy') < TO_DATE(?,'yyyyMMdd') and TO_DATE (TO_CHAR(uiu.data_fine_val, 'DD/MM/yyyy'),'DD/MM/yyyy') >= TO_DATE(?,'yyyyMMdd')
rengine.jchain.in.9.key=SQL_TITOLARI_UIU_ANNO_DOCFA
rengine.jchain.in.9.value=select s.pkid, s.pk_cuaa, deco.description tipo_titolo, c.perc_poss, c.data_inizio data_inizio_possesso,c.data_fine data_fine_possesso, s.codi_fisc cod_fiscale,s.codi_piva piva, s.ragi_soci, s.nome, s.sesso, s.data_nasc, s.data_morte, s.comu_nasc, s.flag_pers_fisica from siticonduz_imm_all C, CONS_SOGG_TAB S , CONS_DECO_TAB DECO WHERE deco.tablename = 'CONS_ATTI_TAB' AND deco.fieldname = 'TIPO_DOCUMENTO' AND deco.code = c.tipo_documento AND COD_NAZIONALE = ? AND FOGLIO = ? AND PARTICELLA = ? AND UNIMM = ? AND S.PK_CUAA = C.PK_CUAA AND C.DATA_INIZIO <= TO_DATE('3112'||TO_CHAR(TO_DATE(?,'yyyyMMDD'),'YYYY'),'ddMMyyyy') AND C.DATA_FINE  >= TO_DATE('0101'||TO_CHAR(TO_DATE(?,'yyyyMMDD'),'YYYY'),'ddMMyyyy') AND s.data_fine = TO_DATE ('99991231', 'yyyyMMDD')
rengine.jchain.in.10.key=SQL_INDICE_TITOLARE_CatAnagrafe
rengine.jchain.in.10.value=select B.ID_DWH ID_ANA_PERS, P.ID_EXT ID_EXT_PERSONA  from sit_soggetto_totale a , sit_soggetto_totale  b, SIT_D_PERSONA P where a.fk_ente_sorgente = '4' and a.prog_es='3' and  b.fk_ente_sorgente = '1' and b.prog_es = '1' and a.fk_soggetto =b.fk_soggetto and a.id_dwh = ? AND P.DT_FINE_VAL IS NULL AND P.ID = B.ID_DWH
rengine.jchain.in.11.key=SQL_RESIDENZA_TITOLARE
rengine.jchain.in.11.value=SELECT C.ID AS ANA_CIVICO_RESIDENZA FROM SIT_D_PERSONA_CIVICO  PC, SIT_D_CIVICO C WHERE PC.ID_EXT_D_PERSONA = ? AND TO_DATE(?,'YYYYMMDD') BETWEEN NVL(PC.DT_INIZIO_DATO,TO_DATE('01-01-0001','DD-MM-YYYY'))  AND NVL(PC.DT_FINE_DATO,TO_DATE('31-12-9999','DD-MM-YYYY')) AND PC.ID_EXT_D_CIVICO = C.ID_EXT AND C.DT_FINE_VAL IS NULL
rengine.jchain.in.12.key=SQL_INDICE_RESIDENZA_CIVICO_CATASTO
rengine.jchain.in.12.value=select * from sit_civico_totale a , sit_civico_totale b where a.fk_ente_sorgente = '1' and a.prog_es='1' and  b.fk_ente_sorgente = '4' and b.prog_es = '2' and a.fk_civico =b.fk_civico and a.id_dwh = ? and b.id_dwh IN (SELECT CU.PKID_CIVI INDIR_CAT_IMMOBILE FROM SITICIVI_UIU CU, SITIUIU U, SITICIVI C, SITIDSTR S WHERE CU.PKID_UIU = U.PKID_UIU AND U.COD_NAZIONALE = ? AND U.FOGLIO = ? AND U.PARTICELLA = ? AND U.UNIMM = ? AND CU.PKID_CIVI = C.PKID_CIVI AND CU.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.DATA_FINE_VAL = TO_DATE('31-12-9999','DD-MM-YYYY') AND C.PKID_STRA = S.PKID_STRA)
rengine.jchain.in.13.key=SQL_INDICE_RESIDENZA_CIVICO_DOCFA
rengine.jchain.in.13.value=select * from sit_civico_totale a , sit_civico_totale b where a.fk_ente_sorgente \= '1' and a.prog_es\='1' and  b.fk_ente_sorgente \= '9' and b.prog_es \= '3' and a.fk_civico \=b.fk_civico and a.id_dwh \= ? and b.id_dwh \= ? 
rengine.jchain.in.14.key=SQL_DOCFA_CONTEMPORANEI
rengine.jchain.in.14.value= select distinct count(ddc.protocollo_registrazione)docfa_contemporanei FROM docfa_dati_censuari ddc left join docfa_uiu du on (DDC.FORNITURA \= DU.FORNITURA and DDC.PROTOCOLLO_REGISTRAZIONE \= DU.PROTOCOLLO_REG and DDC.FOGLIO \= DU.FOGLIO and DDC.NUMERO \= DU.NUMERO and NVL(DDC.SUBALTERNO,'-') \= nvl(DECODE(TRIM(du.SUBALTERNO),'',NULL,du.SUBALTERNO),'-')) where ddc.foglio \= ? AND ddc.numero \= ? AND NVL(ddc.subalterno,'-') \= ? AND ddc.data_registrazione \= ? AND DU.TIPO_OPERAZIONE \= ? 
rengine.jchain.in.15.key =SQL_SUPERFICI_PER_VANO
rengine.jchain.in.15.value = select ddm.ambiente, ddm.superficie, ddm.altezza from docfa_dati_metrici ddm where DDM.FORNITURA = ? AND DDM.PROTOCOLLO_REGISTRAZIONE = ? AND DDM.DATA_REGISTRAZIONE = ? AND DDM.IDENTIFICATIVO_IMMOBILE = ?
rengine.jchain.in.16.key=SQL_DOCFA_DATI_CENSUARI
rengine.jchain.in.16.value= select identificativo_immobile,codice_amminstrativo, data_registrazione, categoria, superficie, consistenza, toponimo,indirizzo, civico_1, civico_2, civico_3 from docfa_dati_censuari ddc where fornitura = ? AND protocollo_registrazione = ?  AND foglio = ? AND numero = ? AND NVL (ddc.subalterno, '-') = ?
rengine.jchain.in.17.key=SQL_DOCFA_DATI_GENERALI
rengine.jchain.in.17.value= select * from docfa_dati_generali where fornitura = ? AND protocollo_reg = ?
rengine.jchain.in.18.key=SQL_DOCFA_DATA_REGISTRAZIONE
rengine.jchain.in.18.value= select distinct data_registrazione from docfa_dati_censuari ddc where fornitura \= ? AND protocollo_registrazione \= ? 
rengine.jchain.in.19.key=SQL_DOCFA_DICHIARANTE
rengine.jchain.in.19.value= select distinct DIC_NOME, DIC_COGNOME, DIC_RES_INDIR, DIC_RES_NUMCIV, DIC_RES_COM, DIC_RES_CAP, DIC_RES_PROV  from docfa_dichiaranti  where FORNITURA = ? AND PROTOCOLLO_REG = ?
rengine.jchain.in.20.key=SQL_SOGG_TAR_PRECEDENTE_UIU
rengine.jchain.in.20.value=SELECT o.* FROM sit_soggetto_totale a,sit_soggetto_totale b,sit_t_tar_sogg s,sit_t_tar_contrib c,sit_t_tar_oggetto o WHERE a.fk_ente_sorgente = ? AND a.prog_es = ? AND a.id_dwh = ? AND a.fk_soggetto = b.fk_soggetto AND b.fk_ente_sorgente = '2' AND b.prog_es = '4' AND s.ID = b.id_dwh AND c.id_ext_sogg = s.id_ext AND o.id_ext = c.id_ext_ogg_rsu  AND O.DAT_INI < TO_DATE (?, 'yyyyMMdd') AND o.foglio = ? AND o.numero = ? AND LPAD (NVL (o.sub, '0'), 4, '0') = ?
rengine.jchain.in.21.key=SQL_SOGG_TAR_SUCCESSIVO_UIU
rengine.jchain.in.21.value=SELECT o.* FROM sit_soggetto_totale a,sit_soggetto_totale b,sit_t_tar_sogg s,sit_t_tar_contrib c,sit_t_tar_oggetto o WHERE a.fk_ente_sorgente \= ? AND a.prog_es \= ? AND a.id_dwh \= ? AND a.fk_soggetto \= b.fk_soggetto AND b.fk_ente_sorgente \= '2' AND b.prog_es \= '4' AND s.ID \= b.id_dwh AND c.id_ext_sogg \= s.id_ext AND o.id_ext \= c.id_ext_ogg_rsu  AND o.dat_ini >\= TO_DATE (?, 'YYYYMMDD') AND o.dat_ini < TO_DATE (?, 'YYYYMMDD') AND o.foglio \= ? AND o.numero \= ? AND LPAD (NVL (o.sub, '0'), 4, '0') \= ?
rengine.jchain.in.22.key=SQL_SOGG_TAR_PRECEDENTE_UND
rengine.jchain.in.22.value=SELECT o.* FROM sit_soggetto_totale a, sit_soggetto_totale b, sit_t_tar_sogg s, sit_t_tar_contrib c,(SELECT tar.* from sit_t_tar_oggetto tar WHERE (tar.foglio is null OR tar.foglio \= ? ) AND (tar.numero is null OR tar.numero \= ? ) AND (LPAD(NVL(TRIM(tar.SUB),'0'),4,'0') \= '0000' OR LPAD(NVL(TRIM(tar.SUB),'0'),4,'0') \= ? ) MINUS SELECT tar.* FROM sit_t_tar_oggetto tar WHERE tar.foglio \= ? AND tar.numero \= ? AND LPAD(NVL(TRIM(tar.SUB),'0'),4,'0') \= ?) o WHERE a.fk_ente_sorgente \= ? AND a.prog_es \= ? AND a.id_dwh \= ? AND a.fk_soggetto \= b.fk_soggetto AND b.fk_ente_sorgente \= '2' AND b.prog_es \= '4' AND b.id_dwh \= s.id  AND S.ID_EXT \= C.ID_EXT_SOGG AND O.ID_EXT \= C.ID_EXT_OGG_RSU AND o.dat_ini < TO_DATE (?, 'YYYYMMDD') 
rengine.jchain.in.23.key=SQL_SOGG_TAR_SUCCESSIVO_UND
rengine.jchain.in.23.value=SELECT o.* FROM sit_soggetto_totale a, sit_soggetto_totale b, sit_t_tar_sogg s, sit_t_tar_contrib c,(SELECT tar.* from sit_t_tar_oggetto tar WHERE (tar.foglio is null OR tar.foglio \= ? ) AND (tar.numero is null OR tar.numero \= ? ) AND (LPAD(NVL(TRIM(tar.SUB),'0'),4,'0') \= '0000' OR LPAD(NVL(TRIM(tar.SUB),'0'),4,'0') \= ? ) MINUS SELECT tar.* FROM sit_t_tar_oggetto tar WHERE tar.foglio \= ? AND tar.numero \= ? AND LPAD(NVL(TRIM(tar.SUB),'0'),4,'0') \= ?) o WHERE a.fk_ente_sorgente \= ? AND a.prog_es \= ? AND a.id_dwh \= ? AND a.fk_soggetto \= b.fk_soggetto AND b.fk_ente_sorgente \= '2' AND b.prog_es \= '4' AND b.id_dwh \= s.id  AND S.ID_EXT \= C.ID_EXT_SOGG AND O.ID_EXT \= C.ID_EXT_OGG_RSU AND o.dat_ini >\= TO_DATE (?, 'YYYYMMDD') AND o.dat_ini < TO_DATE(?,'YYYYMMDD') ORDER BY o.dat_ini, o.dat_fin
rengine.jchain.in.24.key=SQL_SOGG_TAR_PRECEDENTE_CIV
rengine.jchain.in.24.value=SELECT DISTINCT taro.*, tarv.ID || '|' || NVL(taro.NUM_CIV, '') || '|' || NVL(taro.ESP_CIV, '') AS ID_DWH, tarv.ID_EXT ID_STORICO, taro.NUM_CIV AS CIV_LIV1, taro.ESP_CIV AS CIV_LIV2, NULL AS CIV_LIV3, tarv.ID AS ID_ORIG_VIA, tarv.PREFISSO AS VIASEDIME, tarv.DESCRIZIONE INDIRIZZO, tarv.DT_FINE_VAL, tarv.ID_ORIG AS CODICE_CIVICO FROM (SELECT o.* FROM sit_soggetto_totale aso, sit_soggetto_totale bso, sit_t_tar_sogg s, sit_t_tar_contrib c, sit_t_tar_oggetto o WHERE aso.fk_ente_sorgente = ? AND aso.prog_es = ? AND aso.id_dwh = ? AND aso.fk_soggetto = bso.fk_soggetto AND bso.fk_ente_sorgente = '2' AND bso.prog_es = '4' AND S.ID = bso.id_dwh AND O.ID_EXT = C.ID_EXT_OGG_RSU AND C.ID_EXT_SOGG = S.ID_EXT AND o.dat_ini < TO_DATE(? ,'yyyyMMdd')) taro INNER JOIN SIT_T_TAR_VIA tarv ON (taro.ID_EXT_VIA = tarv.ID_EXT ) WHERE tarv.ID || '|' || NVL(taro.NUM_CIV, '') || '|' || NVL(taro.ESP_CIV, '') IN (SELECT bc.id_dwh FROM sit_civico_totale ac, sit_civico_totale bc WHERE ac.fk_ente_sorgente = '9' AND ac.prog_es = '3'  AND Ac.FK_CIVICO = Bc.FK_CIVICO AND bc.fk_ente_sorgente = '2' AND bc.prog_es = '3' AND ac.id_dwh = ?)
rengine.jchain.in.25.key=SQL_SOGG_TAR_SUCCESSIVO_CIV
rengine.jchain.in.25.value=SELECT DISTINCT taro.*, tarv.ID || '|' || NVL(taro.NUM_CIV, '') || '|' || NVL(taro.ESP_CIV, '') AS ID_DWH, tarv.ID_EXT ID_STORICO, taro.NUM_CIV AS CIV_LIV1, taro.ESP_CIV AS CIV_LIV2, NULL AS CIV_LIV3, tarv.ID AS ID_ORIG_VIA, tarv.PREFISSO AS VIASEDIME, tarv.DESCRIZIONE INDIRIZZO, tarv.DT_FINE_VAL, tarv.ID_ORIG AS CODICE_CIVICO FROM (SELECT o.* FROM sit_soggetto_totale aso, sit_soggetto_totale bso, sit_t_tar_sogg s, sit_t_tar_contrib c, sit_t_tar_oggetto o WHERE aso.fk_ente_sorgente = ? AND aso.prog_es = ? AND aso.id_dwh = ? AND aso.fk_soggetto = bso.fk_soggetto AND bso.fk_ente_sorgente = '2' AND bso.prog_es = '4' AND S.ID = bso.id_dwh AND O.ID_EXT = C.ID_EXT_OGG_RSU AND C.ID_EXT_SOGG = S.ID_EXT AND o.dat_ini >= TO_DATE(? ,'yyyyMMdd') AND o.dat_ini < TO_DATE(?,'yyyyMMdd')) taro INNER JOIN SIT_T_TAR_VIA tarv ON (taro.ID_EXT_VIA = tarv.ID_EXT ) WHERE tarv.ID || '|' || NVL(taro.NUM_CIV, '') || '|' || NVL(taro.ESP_CIV, '') IN (SELECT bc.id_dwh FROM sit_civico_totale ac, sit_civico_totale bc WHERE ac.fk_ente_sorgente = '9' AND ac.prog_es = '3'  AND Ac.FK_CIVICO = Bc.FK_CIVICO AND bc.fk_ente_sorgente = '2' AND bc.prog_es = '3' AND ac.id_dwh = ?) ORDER BY taro.DAT_INI, taro.DAT_FIN
rengine.jchain.in.26.key=SQL_FAMILIARI_DATA_DOCFA
rengine.jchain.in.26.value=SELECT DISTINCT P2.* FROM SIT_D_PERS_FAM pf2, SIT_D_PERSONA p2,(SELECT  DISTINCT pf1.id_ext_d_famiglia FROM SIT_D_PERSONA p1, SIT_D_PERS_FAM PF1 WHERE p1.ID_EXT IN (select P.ID_EXT ID_EXT_PERSONA  from sit_soggetto_totale a , sit_soggetto_totale  b, SIT_D_PERSONA P where a.fk_ente_sorgente \= '4' and a.prog_es\='3' and  b.fk_ente_sorgente \= '1' and b.prog_es \= '1' and a.fk_soggetto \=b.fk_soggetto and a.id_dwh \= ? AND P.DT_FINE_VAL IS NULL AND P.ID \= B.ID_DWH) AND pf1.ID_EXT_D_PERSONA \= p1.id_ext AND TO_DATE(? ,'YYYYMMDD') BETWEEN  NVL(p1.dt_inizio_dato,TO_DATE('01/01/1000','DD/MM/YYYY')) AND NVL(p1.dt_fine_dato,sysdate) AND TO_DATE(? ,'YYYYMMDD') BETWEEN  NVL(PF1.dt_inizio_dato,TO_DATE('01/01/1000','DD/MM/YYYY')) AND NVL(PF1.dt_fine_dato,sysdate)) fam WHERE  pf2.id_ext_d_famiglia \= fam.id_ext_d_famiglia AND pf2.ID_EXT_D_PERSONA \= p2.ID_EXT AND P2.ID_EXT NOT IN (select P.ID_EXT ID_EXT_PERSONA from sit_soggetto_totale a , sit_soggetto_totale  b, SIT_D_PERSONA P where a.fk_ente_sorgente \= '4' and a.prog_es\='3' and  b.fk_ente_sorgente \= '1' and b.prog_es \= '1' and a.fk_soggetto \=b.fk_soggetto and a.id_dwh \= ? AND P.DT_FINE_VAL IS NULL AND P.ID \= B.ID_DWH) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(pf2.dt_inizio_dato,TO_DATE('10000101','YYYYMMDD')) AND NVL(pf2.dt_fine_dato,sysdate) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(p2.dt_inizio_dato,TO_DATE('10000101','YYYYMMDD')) AND NVL(p2.dt_fine_dato,sysdate) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(P2.DATA_IMM,TO_DATE('10000101','YYYYMMDD')) AND NVL(P2.DATA_EMI,sysdate) AND TO_DATE (?, 'YYYYMMDD') BETWEEN  NVL(P2.DATA_NASCITA,TO_DATE('10000101','YYYYMMDD')) AND NVL(P2.DATA_MOR,sysdate) AND TO_DATE (? , 'YYYYMMDD') >\= NVL(P2.DATA_INIZIO_RESIDENZA,TO_DATE('10000101','YYYYMMDD'))
rengine.jchain.in.27.key=SQL_DOCFA_IN_PARTE_DUE_H
rengine.jchain.in.27.value= select d.* from Docfa_In_Parte_Due_H d where d.protocollo_Reg = ? and d.fornitura = ? and ((d.ct_Foglio_01 = LPAD(?, 4, '0') and d.ct_Numero_01 = LPAD(?, 5, '0') and LPAD(NVL (d.ct_Subalterno_01, '0'), 4, '0') = LPAD(?, 4, '0')) or (d.ct_Foglio_02 = LPAD(?, 4, '0') and d.ct_Numero_02 = LPAD(?, 5, '0') and LPAD(NVL (d.ct_Subalterno_02, '0'), 4, '0') = LPAD(?, 4, '0')) or (d.ct_Foglio_03 = LPAD(?, 4, '0') and d.ct_Numero_03 = LPAD(?, 5, '0') and LPAD(NVL (d.ct_Subalterno_03, '0'), 4, '0') = LPAD(?, 4, '0')) or (d.ct_Foglio_04 = LPAD(?, 4, '0') and d.ct_Numero_04 = LPAD(?, 5, '0') and LPAD(NVL (d.ct_Subalterno_04, '0'), 4, '0') = LPAD(?, 4, '0')))