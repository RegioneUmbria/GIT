sql.CATASTO_INDIRIZZI=SELECT ind.ID_IMM || '|' || ind.PROGRESSIVO || '|' || ind.SEQ as ID_DWH  ,ltrim(id.foglio,'0') FOGLIO, id.mappale PARTICELLA, ltrim(id.sub,0) SUBALTERNO, ind.civ1 CIVICO FROM load_cat_uiu_ind IND , LOAD_CAT_UIU_ID ID , siticomu c WHERE c.cod_nazionale in ( select cod_nazionale from siticomu where codi_fisc_luna = ?) and ID.codi_fisc_luna \= c.codi_fisc_luna AND ID.ID_IMM \= IND.ID_IMM AND ID.sezione \= ind.sezione AND ID.progressivo \= ind.progressivo AND ind.SEQ \=  (SELECT MAX(SEQ) FROM load_cat_uiu_ind IND2 WHERE IND2.ID_IMM \= IND.ID_IMM AND IND2.CODI_FISC_LUNA \= IND.CODI_FISC_LUNA AND IND2.PROGRESSIVO \= IND.PROGRESSIVO) AND ind.PROGRESSIVO \= (SELECT MAX(ind2.PROGRESSIVO) FROM load_cat_uiu_ind IND2 WHERE IND2.ID_IMM \= IND.ID_IMM AND IND2.CODI_FISC_LUNA \= IND.CODI_FISC_LUNA ) AND ind.ERROR_CODE IS NULL
sql.FIND_VIA_DA_CAT_A_SITIDSTR=SELECT M.ID_DWH_B AS ID_DWH FROM SIT_MATRICE_VIE_T M WHERE ES_A \= 4 AND ES_B\=4 AND PROG_ES_A \= 2 AND PROG_ES_B\=1 AND ID_DWH_A \= ? 
sql.FIND_SITICIVI=select PKID_CIVI from siticivi where PKID_STRA \= ? AND COD_NAZIONALE \= ? AND CIVICO \= nvl(?,'0') AND DATA_FINE_VAL \=TO_DATE('31-12-9999','DD-MM-YYYY')
sql.INSERT_SITICIVI=insert into siticivi(PKID_STRA, COD_NAZIONALE, CIVICO,DATA_INIZIO_VAL, DATA_FINE_VAL,utente) values (?,?,?,to_date('01-01-1990','dd-mm-yyyy'),to_date('31-12-9999','dd-mm-yyyy'),'RulEngine')
sql.INSERT_SITICIVI_UIU=insert into siticivi_uiu (PKID_CIVI,PKID_UIU,DATA_INIZIO_VAL, DATA_FINE_VAL, UTENTE, PRINCIPALE) SELECT  ? , PKID_UIU, TO_DATE('01-01-1900','DD-MM-YYYY'),TO_DATE('31-12-9999','DD-MM-YYYY'),'RulEngine','Y' FROM SITIUIU U WHERE IDE_IMMO \= ? and not exists (select 1 from siticivi_uiu cu where cu.PKID_CIVI \= ? and cu.PKID_UIU \= U.PKID_UIU AND CU.DATA_FINE_VAL \= TO_DATE('31-12-9999','DD-MM-YYYY'))
sql.DELETE_SITICIVI_UIU=delete siticivi_uiu where utente='RulEngine'
sql.DELETE_SITICIVI=delete siticivi where utente='RulEngine'
sql.INSERT_SITICIVI_TUTTI_CIVICI=insert into siticivi(PKID_STRA, COD_NAZIONALE, CIVICO,DATA_INIZIO_VAL, DATA_FINE_VAL,utente) select DISTINCT vt_sit.ID_DWH id_via_sit, e.codent , LTRIM(CIV_LIV1,'0') , to_date('01-01-1990','dd-mm-yyyy'), to_date('31-12-9999','dd-mm-yyyy'),'RulEngine' from sit_civico_TOTALE CT, SIT_VIA_TOTALE VT, SIT_VIA_TOTALE VT_SIT, SIT_ENTE E where E.CODENT \= ? AND not exists ( select 1 from sit_civico_totale t where t.FK_ENTE_SORGENTE \= 4 and prog_es \= 2 and t.FK_CIVICO \= CT.FK_civico ) AND CT.ID_ORIG_VIA_TOTALE \= VT.ID_DWH AND CT.FK_ENTE_SORGENTE \= VT.FK_ENTE_SORGENTE AND CT.PROG_ES \= VT.PROG_ES AND vt_sit.FK_VIA \= VT.FK_VIA AND vt_sit.FK_ENTE_SORGENTE \= 4 and vt_sit.prog_es \= 1 and not exists ( select 1 from siticivi where civico \= LTRIM(CIV_LIV1,'0') and pkid_stra \= vt_sit.ID_DWH ) and LTRIM(CIV_LIV1,'0') is not null
