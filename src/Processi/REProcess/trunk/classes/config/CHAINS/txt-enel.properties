#--------------------------------------------------------------
# File di configurazione in cui sono indicato i valori dei soli
# parametri di contesto della catena jelly da passare alla 
# regola 
#------------------------------------------------------------
# Numero di parametri previsti in input
rengine.jchain.in.nof=4
#------------------------------------------------------------
# Le coppie chiavi/valore hanno come key lo stesso nome 
# indicato nello script jelly xml
#------------------------------------------------------------
rengine.jchain.in.1.key=QUERYSQL_1
rengine.jchain.in.1.value=SELECT TRIM (SUBSTR (riga_enel, 1, 1)) tipo_record, TRIM (SUBSTR (riga_enel, 2, 1)) tipologia_fornitura, TRIM (SUBSTR (riga_enel, 43, 1)) tipo_soggetto, DECODE(LENGTH(TRIM (SUBSTR (riga_enel, 44, 24))),24, TRIM(SUBSTR (riga_enel, 44, 24)) || TRIM (SUBSTR (riga_enel, 68, 20)), TRIM(SUBSTR (riga_enel, 44, 24)) || ' ' || TRIM (SUBSTR (riga_enel, 68, 20)) ) DENOMINAZIONE, TRIM (SUBSTR (riga_enel, 3, 4)) anno_riferimento_dati, TRIM (SUBSTR (riga_enel, 7, 4)) belfiore_utenza, TRIM (SUBSTR (riga_enel, 11, 16)) codice_fiscale_erogante, TRIM (SUBSTR (riga_enel, 27, 16)) cod_fis_titolare_utenza, TRIM (SUBSTR (riga_enel, 88, 1)) sesso, UTIL.FCHAR_TO_DATE(TRIM (SUBSTR (riga_enel, 89, 8)),'DDMMYYYY') data_nascita, TRIM (SUBSTR (riga_enel, 97, 25)) comune_nascita, TRIM (SUBSTR (riga_enel, 122, 2)) prov_nascita, TRIM (SUBSTR (riga_enel, 124, 14)) codice_utenza, TRIM (SUBSTR (riga_enel, 138, 3)) codice_merceologico, TRIM (SUBSTR (riga_enel, 141, 1)) tipo_utenza, TRIM (SUBSTR (riga_enel, 142, 35)) indirizzo_ubicazione, TRIM (SUBSTR (riga_enel, 177, 5)) cap_ubicazione, TRIM (SUBSTR (riga_enel, 182, 13)) spesa_annua, TRIM (SUBSTR (riga_enel, 195, 10)) kwh_fatturati, TRIM (SUBSTR (riga_enel, 205, 2)) mesi_fatturazione, null DATA_PRIMA_ATTIVAZIONE, NULL COMUNE_AMM_UBICAZIONE, NULL PROVINCIA_AMM_UBICAZIONE, NULL COMUNE_CATASTALE, NULL CODICE_COMUNE_CATASTALE, NULL TIPO_UNITA, NULL SEZIONE, NULL FOGLIO, null PARTICELLA, NULL ESTENSIONE_PARTICELLA, NULL TIPO_PARTICELLA , NULL SUBALTERNO, NULL CODICE_ASSENZA_CATASTO, NULL COMUNE_DOM_FISCALE, NULL PROVINCIA_DOM_FISCALE, NULL QUALIFICA_TITOLARE, NULL SEGNO_IMPORTO, SYSDATE DT_EXP_DATO, TRIM (SUBSTR (riga_enel, 27, 16)) ID_EXT_ENEL_UTENTE FROM re_enel_1_0 WHERE SUBSTR (riga_enel, 1, 1) \= '1' AND SUBSTR (riga_enel, 2, 1) \= 'E' and re_flag_elaborato \= '0' AND TO_NUMBER(TRIM (SUBSTR (riga_enel, 3, 4))) < 2012 UNION ALL SELECT TRIM (SUBSTR (riga_enel, 1, 1)) tipo_record, TRIM (SUBSTR (riga_enel, 2, 1)) tipologia_fornitura, TRIM (SUBSTR (riga_enel, 43, 1)) tipo_soggetto, DECODE(LENGTH(TRIM (SUBSTR (riga_enel, 44, 24))),24, TRIM(SUBSTR (riga_enel, 44, 24)) || TRIM (SUBSTR (riga_enel, 68, 20)), TRIM(SUBSTR (riga_enel, 44, 24)) || ' ' || TRIM (SUBSTR (riga_enel, 68, 20)) ) DENOMINAZIONE, TRIM (SUBSTR (riga_enel, 3, 4)) anno_riferimento_dati, TRIM (SUBSTR (riga_enel, 7, 4)) belfiore_utenza, TRIM (SUBSTR (riga_enel, 11, 16)) codice_fiscale_erogante, TRIM (SUBSTR (riga_enel, 27, 16)) cod_fis_titolare_utenza, TRIM (SUBSTR (riga_enel, 88, 1)) sesso, UTIL.FCHAR_TO_DATE(TRIM (SUBSTR (riga_enel, 89, 8)),'DDMMYYYY') data_nascita, TRIM (SUBSTR (riga_enel, 97, 25)) comune_nascita, TRIM (SUBSTR (riga_enel, 122, 2)) prov_nascita, TRIM (SUBSTR (riga_enel, 124, 14)) codice_utenza, TRIM (SUBSTR (riga_enel, 138, 3)) codice_merceologico, TRIM (SUBSTR (riga_enel, 141, 1)) tipo_utenza, TRIM (SUBSTR (riga_enel, 142, 35)) indirizzo_ubicazione, TRIM (SUBSTR (riga_enel, 177, 5)) cap_ubicazione, TRIM (SUBSTR (riga_enel, 183, 13)) spesa_annua, TRIM (SUBSTR (riga_enel, 196, 10)) kwh_fatturati, TRIM (SUBSTR (riga_enel, 206, 2)) mesi_fatturazione, null DATA_PRIMA_ATTIVAZIONE, NULL COMUNE_AMM_UBICAZIONE, NULL PROVINCIA_AMM_UBICAZIONE, NULL COMUNE_CATASTALE, NULL CODICE_COMUNE_CATASTALE, NULL TIPO_UNITA, NULL SEZIONE, NULL FOGLIO, null PARTICELLA, NULL ESTENSIONE_PARTICELLA, NULL TIPO_PARTICELLA , NULL SUBALTERNO, NULL CODICE_ASSENZA_CATASTO, NULL COMUNE_DOM_FISCALE, NULL PROVINCIA_DOM_FISCALE, NULL QUALIFICA_TITOLARE, TRIM (SUBSTR (riga_enel, 182, 1)) SEGNO_IMPORTO, SYSDATE DT_EXP_DATO, TRIM (SUBSTR (riga_enel, 27, 16)) ID_EXT_ENEL_UTENTE FROM re_enel_1_0 WHERE SUBSTR (riga_enel, 1, 1) \= '1' AND SUBSTR (riga_enel, 2, 1) \= 'E' and re_flag_elaborato \= '0' AND TO_NUMBER(TRIM (SUBSTR (riga_enel, 3, 4))) >\= 2012
rengine.jchain.in.2.key=RSITRSCRIPT_1
rengine.jchain.in.2.value=<RsIterator><key table="RE_ENEL_1_0"><column name="COD_FIS_TITOLARE_UTENZA"/><column name="DT_EXP_DATO"/></key><commands><command name="SIT_EN_UTT"><param id="field" value="COD_FIS_TITOLARE_UTENZA" dest="ID_ORIG" type="java.lang.String"/><param id="const" value="10" dest="FK_ENTE_SORGENTE" type="java.lang.Integer"/><param id="field" value="COD_FIS_TITOLARE_UTENZA" dest="CODICE_FISCALE" type="java.lang.String"/><param id="field" value="DENOMINAZIONE" dest="DENOMINAZIONE" type="java.lang.String"/><param id="field" value="SESSO" dest="SESSO" type="java.lang.String"/><param id="field" value="DATA_NASCITA" dest="DATA_NASCITA" type="java.sql.Timestamp"/><param id="field" value="comune_nascita" dest="COMUNE_NASCITA_SEDE" type="java.lang.String"/><param id="field" value="prov_nascita" dest="PROVINCIA_NASCITA_SEDE" type="java.lang.String"/><param id="field" value="comune_nascita" dest="COMUNE_NASCITA_SEDE" type="java.lang.String"/><param id="field" value="COMUNE_DOM_FISCALE" dest="COMUNE_DOM_FISCALE" type="java.lang.String"/><param id="field" value="PROVINCIA_DOM_FISCALE" dest="PROVINCIA_DOM_FISCALE" type="java.lang.String"/><param id="field" value="QUALIFICA_TITOLARE" dest="QUALIFICA_TITOLARE" type="java.lang.String"/><param id="field" value="DT_EXP_DATO" dest="DT_EXP_DATO" type="java.sql.Timestamp"/><param id="const" value="" dest="DT_INI_VAL_DATO" type="java.sql.Timestamp"/><param id="const" value="" dest="DT_FINE_VAL_DATO" type="java.sql.Timestamp"/><param id="const" value="0" dest="FLAG_DT_VAL_DATO" type="java.lang.Integer"/></command><command name="SIT_EN_UTZ"><param id="const" value="" dest="ID_ORIG" type="java.lang.String"/><param id="const" value="10" dest="FK_ENTE_SORGENTE" type="java.lang.Integer"/><param id="field" value="CODICE_FISCALE_EROGANTE" dest="CODICE_FISCALE_EROGANTE" type="java.lang.String"/><param id="field" value="CODICE_UTENZA" dest="CODICE_UTENZA" type="java.lang.String"/><param id="field" value="CODICE_MERCEOLOGICO" dest="CODICE_MERCEOLOGICO" type="java.lang.String"/><param id="field" value="ANNO_RIFERIMENTO_DATI" dest="ANNO_RIFERIMENTO_DATI" type="java.lang.String"/><param id="field" value="DATA_PRIMA_ATTIVAZIONE" dest="DATA_PRIMA_ATTIVAZIONE" type="java.sql.Timestamp"/><param id="field" value="TIPO_UTENZA" dest="TIPO_UTENZA" type="java.lang.String"/><param id="field" value="COMUNE_AMM_UBICAZIONE" dest="COMUNE_AMM_UBICAZIONE" type="java.lang.String"/><param id="field" value="PROVINCIA_AMM_UBICAZIONE" dest="PROVINCIA_AMM_UBICAZIONE" type="java.lang.String"/><param id="field" value="CAP_UBICAZIONE" dest="CAP_UBICAZIONE" type="java.lang.String"/><param id="field" value="COMUNE_CATASTALE" dest="COMUNE_CATASTALE" type="java.lang.String"/><param id="field" value="CODICE_COMUNE_CATASTALE" dest="CODICE_COMUNE_CATASTALE" type="java.lang.String"/><param id="field" value="INDIRIZZO_UBICAZIONE" dest="INDIRIZZO_UBICAZIONE" type="java.lang.String"/><param id="field" value="TIPO_UNITA" dest="TIPO_UNITA" type="java.lang.String"/><param id="field" value="SEZIONE" dest="SEZIONE" type="java.lang.String"/><param id="field" value="FOGLIO" dest="FOGLIO" type="java.lang.String"/><param id="field" value="PARTICELLA" dest="PARTICELLA" type="java.lang.String"/><param id="field" value="ESTENSIONE_PARTICELLA" dest="ESTENSIONE_PARTICELLA" type="java.lang.String"/><param id="field" value="TIPO_PARTICELLA" dest="TIPO_PARTICELLA" type="java.lang.String"/><param id="field" value="SUBALTERNO" dest="SUBALTERNO" type="java.lang.String"/><param id="field" value="CODICE_ASSENZA_CATASTO" dest="CODICE_ASSENZA_CATASTO" type="java.lang.String"/><param id="field" value="MESI_FATTURAZIONE" dest="MESI_FATTURAZIONE" type="java.math.BigDecimal"/><param id="field" value="KWH_FATTURATI" dest="KWH_FATTURATI" type="java.math.BigDecimal"/><param id="field" value="SEGNO_IMPORTO" dest="SEGNO_IMPORTO" type="java.lang.String"/><param id="field" value="SPESA_ANNUA" dest="SPESA_ANNUA" type="java.math.BigDecimal"/><param id="field" value="TIPOLOGIA_FORNITURA" dest="TIPOLOGIA_FORNITURA" type="java.lang.String"/><param id="field" value="id_ext_enel_utente" dest="ID_EXT_ENEL_UTENTE" type="java.lang.String"/><param id="field" value="DT_EXP_DATO" dest="DT_EXP_DATO" type="java.sql.Timestamp"/><param id="const" value="" dest="DT_INI_VAL_DATO" type="java.sql.Timestamp"/><param id="const" value="" dest="DT_FINE_VAL_DATO" type="java.sql.Timestamp"/><param id="const" value="0" dest="FLAG_DT_VAL_DATO" type="java.lang.Integer"/></command></commands></RsIterator>
rengine.jchain.in.3.key=COMANDOSQL_1
rengine.jchain.in.3.value=UPDATE RE_ENEL_1_0 SET RE_FLAG_ELABORATO = 1 WHERE RE_FLAG_ELABORATO = 0
rengine.jchain.in.4.key=COMANDOSQL_2
rengine.jchain.in.4.value={call DBMS_SNAPSHOT.REFRESH('SIT_ENEL_UTENZA_INDIR')}