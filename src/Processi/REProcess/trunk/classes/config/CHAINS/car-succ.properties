#--------------------------------------------------------------
# File di configurazione in cui sono indicato i valori dei soli
# parametri di contesto della catena jelly da passare alla 
# regola 
#------------------------------------------------------------
# Numero di parametri previsti in input
rengine.jchain.in.nof=2
#------------------------------------------------------------
# Le coppie chiavi/valore hanno come key lo stesso nome 
# indicato nello script jelly xml
#------------------------------------------------------------
rengine.jchain.in.1.key=COMANDISQL_1
rengine.jchain.in.1.value=INSERT INTO  SUCCESSIONI_A (PK_ID_SUCCA,UFFICIO,ANNO,VOLUME,NUMERO,SOTTONUMERO,COMUNE,PROGRESSIVO,TIPO_DICHIARAZIONE,DATA_APERTURA,CF_DEFUNTO,COGNOME_DEFUNTO,NOME_DEFUNTO,SESSO,CITTA_NASCITA,PROV_NASCITA,DATA_NASCITA,CITTA_RESIDENZA,PROV_RESIDENZA,INDIRIZZO_RESIDENZA,TIPO_RECORD,FORNITURA) SELECT SEQ_SUCCA.nextval PK_ID_SUCCA, SUBSTR_TRIM(RIGA_SUCCESSIONI,2,3) UFFICIO, SUBSTR_TRIM(RIGA_SUCCESSIONI,5,2) ANNO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,7,5)) VOLUME, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,12,6)) NUMERO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,18,3)) SOTTONUMERO, SUBSTR_TRIM(RIGA_SUCCESSIONI,21,4) COMUNE, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,26,5)) PROGRESSIVO, SUBSTR_TRIM(RIGA_SUCCESSIONI,31,1) TIPO_DICHIARAZIONE, SUBSTR_TRIM(RIGA_SUCCESSIONI,32,10) DATA_APERTURA, SUBSTR_TRIM(RIGA_SUCCESSIONI,42,16) CF_DEFUNTO, SUBSTR_TRIM(RIGA_SUCCESSIONI,58,25) COGNOME_DEFUNTO, SUBSTR_TRIM(RIGA_SUCCESSIONI,83,25) NOME_DEFUNTO, SUBSTR_TRIM(RIGA_SUCCESSIONI,108,1) SESSO, SUBSTR_TRIM(RIGA_SUCCESSIONI,109,30) CITTA_NASCITA, SUBSTR_TRIM(RIGA_SUCCESSIONI,139,2) PROV_NASCITA, SUBSTR_TRIM(RIGA_SUCCESSIONI,141,10) DATA_NASCITA, SUBSTR_TRIM(RIGA_SUCCESSIONI,151,30) CITTA_RESIDENZA, SUBSTR_TRIM(RIGA_SUCCESSIONI,181,2) PROV_RESIDENZA, SUBSTR_TRIM(RIGA_SUCCESSIONI,183,30) INDIRIZZO_RESIDENZA, SUBSTR_TRIM(RIGA_SUCCESSIONI,1,1) TIPO_RECORD, TO_NUMBER(TO_CHAR(CARONTE_DATA_INIZIO_VAL, 'YYMMDDHH24MISS')) FORNITURA from successioni_1_0 where caronte_flag_elaborato = 0 and SUBSTR(RIGA_SUCCESSIONI,1,1) = 'A'; INSERT INTO  SUCCESSIONI_B (PK_ID_SUCCB,UFFICIO,ANNO,VOLUME,NUMERO,SOTTONUMERO,COMUNE,PROGRESSIVO,PROGRESSIVO_EREDE,CATEGORIA,CF_EREDE,DENOMINAZIONE,SESSO,CITTA_NASCITA,PROV_NASCITA,DATA_NASCITA,CITTA_RESIDENZA,PROV_RESIDENZA,INDIRIZZO_RESIDENZA,TIPO_RECORD,FORNITURA) SELECT SEQ_SUCCB.nextval PK_ID_SUCCB, SUBSTR_TRIM(RIGA_SUCCESSIONI,2,3) UFFICIO, SUBSTR_TRIM(RIGA_SUCCESSIONI,5,2) ANNO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,7,5)) VOLUME, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,12,6)) NUMERO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,18,3)) SOTTONUMERO, SUBSTR_TRIM(RIGA_SUCCESSIONI,21,4) COMUNE, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,26,5)) PROGRESSIVO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,31,3)) PROGRESSIVO_EREDE, SUBSTR_TRIM(RIGA_SUCCESSIONI,34,1) CATEGORIA, SUBSTR_TRIM(RIGA_SUCCESSIONI,35,16) CF_EREDE, SUBSTR_TRIM(RIGA_SUCCESSIONI,51,50) DENOMINAZIONE, SUBSTR_TRIM(RIGA_SUCCESSIONI,101,1) SESSO, SUBSTR_TRIM(RIGA_SUCCESSIONI,102,30) CITTA_NASCITA, SUBSTR_TRIM(RIGA_SUCCESSIONI,132,2) PROV_NASCITA, SUBSTR_TRIM(RIGA_SUCCESSIONI,134,10) DATA_NASCITA, SUBSTR_TRIM(RIGA_SUCCESSIONI,144,30) CITTA_RESIDENZA, SUBSTR_TRIM(RIGA_SUCCESSIONI,174,2) PROV_RESIDENZA, SUBSTR_TRIM(RIGA_SUCCESSIONI,176,30) INDIRIZZO_RESIDENZA, SUBSTR_TRIM(RIGA_SUCCESSIONI,1,1) TIPO_RECORD, TO_NUMBER(TO_CHAR(CARONTE_DATA_INIZIO_VAL, 'YYMMDDHH24MISS')) FORNITURA         from successioni_1_0 where caronte_flag_elaborato = 0 and SUBSTR(RIGA_SUCCESSIONI,1,1) = 'B'; INSERT INTO SUCCESSIONI_C (UFFICIO,ANNO,VOLUME,NUMERO,SOTTONUMERO,COMUNE,PROGRESSIVO,PROGRESSIVO_IMMOBILE,NUMERATORE_QUOTA_DEF,DENOMINATORE_QUOTA_DEF,DIRITTO,PROGRESSIVO_PARTICELLA,CATASTO,SEZIONE,TIPO_DATI,FOGLIO,PARTICELLA1,PARTICELLA2,SUBALTERNO1,SUBALTERNO2,NATURA,SUPERFICIE_ETTARI,SUPERFICIE_MQ,VANI,INDIRIZZO_IMMOBILE,TIPO_RECORD,FORNITURA) SELECT SUBSTR_TRIM(RIGA_SUCCESSIONI,2,3) UFFICIO, SUBSTR_TRIM(RIGA_SUCCESSIONI,5,2) ANNO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,7,5)) VOLUME, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,12,6)) NUMERO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,18,3)) SOTTONUMERO, SUBSTR_TRIM(RIGA_SUCCESSIONI,21,4) COMUNE, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,26,5)) PROGRESSIVO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,31,3)) PROGRESSIVO_IMMOBILE, SUBSTR_TRIM(RIGA_SUCCESSIONI,34,11) NUMERATORE_QUOTA_DEF, SUBSTR_TRIM(RIGA_SUCCESSIONI,45,6) DENOMINATORE_QUOTA_DEF, SUBSTR_TRIM(RIGA_SUCCESSIONI,51,2) DIRITTO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,53,3)) PROGRESSIVO_PARTICELLA, SUBSTR_TRIM(RIGA_SUCCESSIONI,56,2) CATASTO,  SUBSTR_TRIM(RIGA_SUCCESSIONI,58,2) SEZIONE, SUBSTR_TRIM(RIGA_SUCCESSIONI,60,1) TIPO_DATI, SUBSTR_TRIM(RIGA_SUCCESSIONI,61,4) FOGLIO, SUBSTR_TRIM(RIGA_SUCCESSIONI,65,5) PARTICELLA1, SUBSTR_TRIM(RIGA_SUCCESSIONI,70,2) PARTICELLA2, TO_NUMBER(DECODE(SUBSTR(RIGA_SUCCESSIONI,72,3),'   ',NULL,SUBSTR_TRIM(RIGA_SUCCESSIONI,72,3))) SUBALTERNO1, SUBSTR_TRIM(RIGA_SUCCESSIONI,75,1) SUBALTERNO2, SUBSTR_TRIM(RIGA_SUCCESSIONI,76,3) NATURA, SUBSTR_TRIM(RIGA_SUCCESSIONI,79,5) SUPERFICIE_ETTARI, SUBSTR_TRIM(RIGA_SUCCESSIONI,84,8) SUPERFICIE_MQ, SUBSTR_TRIM(RIGA_SUCCESSIONI,92,5) VANI, SUBSTR_TRIM(RIGA_SUCCESSIONI,97,40) INDIRIZZO_IMMOBILE, SUBSTR_TRIM(RIGA_SUCCESSIONI,1,1) TIPO_RECORD, TO_NUMBER(TO_CHAR(CARONTE_DATA_INIZIO_VAL, 'YYMMDDHH24MISS')) FORNITURA       from successioni_1_0 where caronte_flag_elaborato = 0 and SUBSTR(RIGA_SUCCESSIONI,1,1) = 'C' and SUBSTR(RIGA_SUCCESSIONI,60,1) = '0'; INSERT INTO SUCCESSIONI_C (UFFICIO,ANNO,VOLUME,NUMERO,SOTTONUMERO,COMUNE,PROGRESSIVO,PROGRESSIVO_IMMOBILE,NUMERATORE_QUOTA_DEF,DENOMINATORE_QUOTA_DEF,DIRITTO,PROGRESSIVO_PARTICELLA,CATASTO,SEZIONE,TIPO_DATI,DENUNCIA1,DENUNCIA2,ANNO_DENUNCIA,NATURA,SUPERFICIE_ETTARI,SUPERFICIE_MQ,VANI,INDIRIZZO_IMMOBILE,TIPO_RECORD,FORNITURA ) SELECT SUBSTR_TRIM(RIGA_SUCCESSIONI,2,3) UFFICIO, SUBSTR_TRIM(RIGA_SUCCESSIONI,5,2) ANNO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,7,5)) VOLUME, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,12,6)) NUMERO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,18,3)) SOTTONUMERO, SUBSTR_TRIM(RIGA_SUCCESSIONI,21,4) COMUNE, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,26,5)) PROGRESSIVO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,31,3)) PROGRESSIVO_IMMOBILE, SUBSTR_TRIM(RIGA_SUCCESSIONI,34,11) NUMERATORE_QUOTA_DEF, SUBSTR_TRIM(RIGA_SUCCESSIONI,45,6) DENOMINATORE_QUOTA_DEF, SUBSTR_TRIM(RIGA_SUCCESSIONI,51,2) DIRITTO, TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,53,3)) PROGRESSIVO_PARTICELLA, SUBSTR_TRIM(RIGA_SUCCESSIONI,56,2) CATASTO, SUBSTR_TRIM(RIGA_SUCCESSIONI,58,2) SEZIONE, SUBSTR_TRIM(RIGA_SUCCESSIONI,60,1) TIPO_DATI, SUBSTR_TRIM(RIGA_SUCCESSIONI,61,7) DENUNCIA1, SUBSTR_TRIM(RIGA_SUCCESSIONI,68,3) DENUNCIA2, SUBSTR_TRIM(RIGA_SUCCESSIONI,71,2) ANNO_DENUNCIA, SUBSTR_TRIM(RIGA_SUCCESSIONI,76,3) NATURA, SUBSTR_TRIM(RIGA_SUCCESSIONI,79,5) SUPERFICIE_ETTARI, SUBSTR_TRIM(RIGA_SUCCESSIONI,84,8) SUPERFICIE_MQ, SUBSTR_TRIM(RIGA_SUCCESSIONI,92,5) VANI, SUBSTR_TRIM(RIGA_SUCCESSIONI,97,40) INDIRIZZO_IMMOBILE, SUBSTR_TRIM(RIGA_SUCCESSIONI,1,1) TIPO_RECORD, TO_NUMBER(TO_CHAR(CARONTE_DATA_INIZIO_VAL, 'YYMMDDHH24MISS')) FORNITURA from successioni_1_0  where caronte_flag_elaborato = 0 and SUBSTR(RIGA_SUCCESSIONI,1,1) = 'C' and SUBSTR(RIGA_SUCCESSIONI,60,1) = '1'; INSERT INTO SUCCESSIONI_D (UFFICIO,ANNO,VOLUME,NUMERO,SOTTONUMERO,COMUNE,PROGRESSIVO,PROGRESSIVO_IMMOBILE,PROGRESSIVO_EREDE,NUMERATORE_QUOTA,DENOMINATORE_QUOTA,AGEVOLAZIONE_1_CASA,TIPO_RECORD,FORNITURA) SELECT SUBSTR_TRIM(RIGA_SUCCESSIONI,2,3) UFFICIO,SUBSTR_TRIM(RIGA_SUCCESSIONI,5,2) ANNO,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,7,5)) VOLUME,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,12,6)) NUMERO,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,18,3)) SOTTONUMERO,SUBSTR_TRIM(RIGA_SUCCESSIONI,21,4) COMUNE,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,26,5)) PROGRESSIVO,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,31,3)) PROGRESSIVO_IMMOBILE,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,34,3)) PROGRESSIVO_EREDE,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,37,7)) NUMERATORE_QUOTA,TO_NUMBER_ALL(SUBSTR(RIGA_SUCCESSIONI,44,7)) DENOMINATORE_QUOTA,SUBSTR_TRIM(RIGA_SUCCESSIONI,51,1) AGEVOLAZIONE_1_CASA,SUBSTR_TRIM(RIGA_SUCCESSIONI,1,1) TIPO_RECORD,TO_NUMBER(TO_CHAR(CARONTE_DATA_INIZIO_VAL, 'YYMMDDHH24MISS')) FORNITURA    from successioni_1_0 where caronte_flag_elaborato = 0 and SUBSTR(RIGA_SUCCESSIONI,1,1) = 'D'; UPDATE successioni_1_0 SET caronte_flag_elaborato = 1 where caronte_flag_elaborato = 0;
rengine.jchain.in.2.key=TABELLE_SEMAFORO
rengine.jchain.in.2.value=successioni_1_0