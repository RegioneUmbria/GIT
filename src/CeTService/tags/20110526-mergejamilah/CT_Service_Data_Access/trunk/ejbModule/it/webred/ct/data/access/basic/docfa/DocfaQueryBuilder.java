package it.webred.ct.data.access.basic.docfa;

public class DocfaQueryBuilder {
	private final String SQL_LISTA_DATI_DOCFA_BY_FPS =
		"SELECT U.FORNITURA, U.PROTOCOLLO_REG, C.DATA_REGISTRAZIONE, U.TIPO_OPERAZIONE, INDIR_TOPONIMO, INDIR_NCIV_UNO,  INDIR_NCIV_DUE,  INDIR_NCIV_TRE " +
		"FROM  DOCFA_UIU U, DOCFA_DATI_CENSUARI C " +
		"WHERE LPAD(U.FOGLIO, 4, '0') = LPAD(?,4, '0') " +   
		  "AND LPAD(U.NUMERO, 5, '0') = LPAD(?, 5, '0')" + 
		  "AND LPAD(U.SUBALTERNO, 4,'0')=LPAD(?,4, '0') " +
		  "AND U.FORNITURA=C.FORNITURA " +
		  "AND U.PROTOCOLLO_REG=C.PROTOCOLLO_REGISTRAZIONE " +
		  "AND U.FOGLIO=C.FOGLIO AND U.NUMERO=C.NUMERO AND U.SUBALTERNO=C.SUBALTERNO";

	private final String SQL_LISTA_DATI_DOCFA_BY_FPSubNonVal =	
	"SELECT U.FORNITURA, U.PROTOCOLLO_REG, C.DATA_REGISTRAZIONE, U.TIPO_OPERAZIONE, INDIR_TOPONIMO, INDIR_NCIV_UNO,  INDIR_NCIV_DUE,  INDIR_NCIV_TRE " +
	"FROM  DOCFA_UIU U, DOCFA_DATI_CENSUARI C " +
	"WHERE LPAD(U.FOGLIO, 4, '0') = LPAD(?,4, '0') " +   
  	  "AND LPAD(U.NUMERO, 5, '0') = LPAD(?, 5, '0')" + 
	  "AND (U.SUBALTERNO IS NULL  OR TRIM(U.SUBALTERNO) IS NULL )" +
	  "AND U.FORNITURA=C.FORNITURA " +
	  "AND U.PROTOCOLLO_REG=C.PROTOCOLLO_REGISTRAZIONE " +
	  "AND U.FOGLIO=C.FOGLIO AND U.NUMERO=C.NUMERO   AND nvl(TRIM(U.SUBALTERNO),'0')=nvl(TRIM(C.SUBALTERNO),'0')";

	
	public String getSQL_LISTA_DATI_DOCFA_BY_FPS() {
		return SQL_LISTA_DATI_DOCFA_BY_FPS;
	}

	public String getSQL_LISTA_DATI_DOCFA_BY_FPS(boolean addCondSezione ) {
		String sql = SQL_LISTA_DATI_DOCFA_BY_FPS;
		if (addCondSezione)
			sql += 	"AND  (U.SEZIONE IS NOT NULL AND U.SEZIONE=C.SEZIONE) AND U.SEZIONE =?  ";
		return sql;
			
	}

	public String getSQL_LISTA_DATI_DOCFA_BY_FPSubNonVal() {
		return SQL_LISTA_DATI_DOCFA_BY_FPSubNonVal;
	}
	public String getSQL_LISTA_DATI_DOCFA_BY_FPSubNonVal(boolean addCondSezione ) {
		String sql = SQL_LISTA_DATI_DOCFA_BY_FPSubNonVal;
		if (addCondSezione)
			sql += 	"AND  (U.SEZIONE IS NOT NULL AND U.SEZIONE=C.SEZIONE) AND U.SEZIONE =?  ";
		return sql;
	}
	

}
