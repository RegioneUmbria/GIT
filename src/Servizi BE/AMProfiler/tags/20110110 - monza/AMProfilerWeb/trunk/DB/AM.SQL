DROP TABLE AM_COMUNE CASCADE CONSTRAINTS
;
DROP TABLE AM_USER_AIR CASCADE CONSTRAINTS
;
DROP TABLE AM_USER_GROUP CASCADE CONSTRAINTS
;
DROP TABLE AM_USER CASCADE CONSTRAINTS
;
DROP TABLE AM_ROLE CASCADE CONSTRAINTS
;
DROP TABLE AM_PERMISSION_AIR CASCADE CONSTRAINTS
;
DROP TABLE AM_PERMISSION CASCADE CONSTRAINTS
;
DROP TABLE AM_ITEM CASCADE CONSTRAINTS
;
DROP TABLE AM_GROUP_AIR CASCADE CONSTRAINTS
;
DROP TABLE AM_GROUP CASCADE CONSTRAINTS
;
DROP TABLE AM_AI_ROLE CASCADE CONSTRAINTS
;
DROP TABLE AM_APPLICATION_ITEM CASCADE CONSTRAINTS
;
DROP TABLE AM_APPLICATION CASCADE CONSTRAINTS
;
DROP TABLE AM_SECTION CASCADE CONSTRAINTS
;
DROP TABLE AM_KEY_VALUE CASCADE CONSTRAINTS
;
DROP TABLE AM_ANAGRAFICA CASCADE CONSTRAINTS
;

CREATE TABLE AM_COMUNE
(
  BELFIORE     VARCHAR2(64),
  DESCRIZIONE  VARCHAR2(1024)
);

CREATE TABLE AM_USER_AIR
(
	FK_AM_AI_ROLE  INTEGER,
	FK_AM_USER      VARCHAR2(64)
)
;


CREATE TABLE AM_USER_GROUP
(
	FK_AM_GROUP  VARCHAR2(64),
	FK_AM_USER   VARCHAR2(64)
)
;


CREATE TABLE AM_USER
(
	NAME VARCHAR2(64) NOT NULL,
	PWD VARCHAR2(1024),
	DT_INS DATE,
	USER_INS VARCHAR2(1024),
	LAST_ACCESS DATE,
	DISABLE_CAUSE VARCHAR2(1024),
	DT_UPD_PWD DATE
)
;


CREATE TABLE AM_ROLE
(
	NAME	VARCHAR2(64) NOT NULL
)
;


CREATE TABLE AM_PERMISSION_AIR
(
	FK_AM_PERMISSION    VARCHAR2(64),
	FK_AM_AI_ROLE	 	INTEGER
)
;


CREATE TABLE AM_PERMISSION
(
	NAME VARCHAR2(64) NOT NULL,
	FK_AM_ITEM	VARCHAR2(64)
)
;


CREATE TABLE AM_ITEM
(
	NAME	VARCHAR2(64) NOT NULL
)
;


CREATE TABLE AM_GROUP_AIR
(
	FK_AM_AI_ROLE		INTEGER,
	FK_AM_GROUP         VARCHAR2(64)
)
;


CREATE TABLE AM_GROUP
(
	NAME	VARCHAR2(64) NOT NULL,
	FK_AM_COMUNE  VARCHAR2(64)
)
;


CREATE TABLE AM_AI_ROLE
(
	ID          			INTEGER NOT NULL,
	FK_AM_APPLICATION_ITEM  INTEGER,
	FK_AM_ROLE 				VARCHAR2(64)
)
;


CREATE TABLE AM_APPLICATION_ITEM
(
	ID            			INTEGER NOT NULL,
	FK_AM_APPLICATION 		VARCHAR2(64),
	FK_AM_ITEM              VARCHAR2(64)
)
;


CREATE TABLE AM_APPLICATION
(
	NAME			VARCHAR2(64) NOT NULL,
	URL				VARCHAR2(1024),
	FK_AM_COMUNE	VARCHAR2(64),
	APP_TYPE		VARCHAR2(1024),
	APP_CATEGORY	VARCHAR2(1024)
)
;

CREATE TABLE AM_SECTION
(	
	ID            		INTEGER NOT NULL,
	NAME				VARCHAR2(64) NOT NULL,
	FK_AM_APPLICATION	VARCHAR2(64),
	FK_AM_COMUNE		VARCHAR2(64)
)
;

CREATE TABLE AM_KEY_VALUE
(	
	ID            		INTEGER NOT NULL,
	KEY_CONF			VARCHAR2(64),
	VALUE_CONF			VARCHAR2(2048),
	KEY_INDEX			INTEGER,
	DELETED 			DATE,
	FK_AM_SECTION		INTEGER
)
;

CREATE TABLE AM_ANAGRAFICA
(
	ID            		INTEGER NOT NULL,
	CAP					VARCHAR2(8),
	CITTADINANZA		VARCHAR2(64),
	CODICE_FISCALE		VARCHAR2(16),
	COGNOME				VARCHAR2(64),
	COMUNE_NASCITA		VARCHAR2(64),
	COMUNE_RESIDENZA	VARCHAR2(64),
	DATA_NASCITA		DATE,
	INDIRIZZO			VARCHAR2(64),
	NOME				VARCHAR2(64),
	NUMERO				VARCHAR2(8),
	PROVINCIA_NASCITA	VARCHAR2(64),
	PROVINCIA_RESIDENZA	VARCHAR2(64),
	SESSO				VARCHAR2(8),
	FK_AM_USER 			VARCHAR2(64),
	FK_CeT_ANAGRAGICA 	INTEGER
)
;


ALTER TABLE AM_SECTION ADD CONSTRAINT PK_AM_SECTION 
	PRIMARY KEY (ID)
;

ALTER TABLE AM_KEY_VALUE ADD CONSTRAINT PK_AM_KEY_VALUE 
	PRIMARY KEY (ID)
;

ALTER TABLE AM_COMUNE ADD CONSTRAINT PK_AM_COMUNE 
	PRIMARY KEY (BELFIORE)
;

ALTER TABLE AM_USER ADD CONSTRAINT PK_AM_USER 
	PRIMARY KEY (NAME)
;

ALTER TABLE AM_ROLE ADD CONSTRAINT PK_AM_ROLE 
	PRIMARY KEY (NAME)
;

ALTER TABLE AM_PERMISSION ADD CONSTRAINT PK_AM_PERMISSION 
	PRIMARY KEY (NAME)
;

ALTER TABLE AM_ITEM ADD CONSTRAINT PK_AM_ITEM 
	PRIMARY KEY (NAME)
;


ALTER TABLE AM_GROUP ADD CONSTRAINT PK_AM_GROUP 
	PRIMARY KEY (NAME)
;

ALTER TABLE AM_AI_ROLE ADD CONSTRAINT PK_AM_AI_ROLE 
	PRIMARY KEY (ID)
;

ALTER TABLE AM_ANAGRAFICA ADD CONSTRAINT PK_AM_ANAGRAFICA 
	PRIMARY KEY (ID)
;

ALTER TABLE AM_APPLICATION_ITEM ADD CONSTRAINT PK_AM_APPLICATION_ITEM 
	PRIMARY KEY (ID)
;

ALTER TABLE AM_APPLICATION ADD CONSTRAINT PK_AM_APPLICATION 
	PRIMARY KEY (NAME)
;

ALTER TABLE AM_SECTION ADD CONSTRAINT FK_AM_SECTION_AM_APPLICATION 
 FOREIGN KEY (FK_AM_APPLICATION) REFERENCES AM_APPLICATION (NAME)
;

ALTER TABLE AM_SECTION ADD CONSTRAINT FK_AM_SECTION_AM_COMUNE 
 FOREIGN KEY (FK_AM_COMUNE) REFERENCES AM_COMUNE (BELFIORE)
;

ALTER TABLE AM_SECTION ADD CONSTRAINT UQ_AM_SECTION_APPLICATION
 UNIQUE( FK_AM_APPLICATION, NAME)
;

ALTER TABLE AM_SECTION ADD CONSTRAINT UQ_AM_SECTION_COMUNE
 UNIQUE( FK_AM_COMUNE, NAME)
;

ALTER TABLE AM_SECTION ADD CONSTRAINT UQ_AM_SECTION
 UNIQUE( FK_AM_APPLICATION, FK_AM_COMUNE, NAME)
;




ALTER TABLE AM_KEY_VALUE ADD CONSTRAINT FK_AM_KEY_VALUE_AM_SECTION 
 FOREIGN KEY (FK_AM_SECTION) REFERENCES AM_SECTION (ID)
;

ALTER TABLE AM_USER_AIR ADD CONSTRAINT FK_AM_USER_AIR_AM_AI_ROLE 
	FOREIGN KEY (FK_AM_AI_ROLE) REFERENCES AM_AI_ROLE (ID)
;

ALTER TABLE AM_USER_AIR ADD CONSTRAINT FK_AM_USER_AIR_AM_USER 
	FOREIGN KEY (FK_AM_USER) REFERENCES AM_USER (NAME)
;

ALTER TABLE AM_USER_GROUP ADD CONSTRAINT FK_AM_USER_GROUP_AM_GROUP 
	FOREIGN KEY (FK_AM_GROUP) REFERENCES AM_GROUP (NAME)
;

ALTER TABLE AM_USER_GROUP ADD CONSTRAINT FK_AM_USER_GROUP_AM_USER 
	FOREIGN KEY (FK_AM_USER) REFERENCES AM_USER (NAME)
;

ALTER TABLE AM_PERMISSION_AIR ADD CONSTRAINT FK_AM_PAIR_AM_PERMISSION 
	FOREIGN KEY (FK_AM_PERMISSION) REFERENCES AM_PERMISSION (NAME)
;

ALTER TABLE AM_PERMISSION_AIR ADD CONSTRAINT FK_AM_PAIR_AM_GAI_ROLE 
	FOREIGN KEY (FK_AM_AI_ROLE) REFERENCES AM_AI_ROLE (ID)
;

ALTER TABLE AM_PERMISSION ADD CONSTRAINT FK_AM_PERMISSION_AM_ITEM 
	FOREIGN KEY (FK_AM_ITEM) REFERENCES AM_ITEM (NAME)
;

ALTER TABLE AM_GROUP_AIR ADD CONSTRAINT FK_AM_GAIR_AM_AI_ROLE 
	FOREIGN KEY (FK_AM_AI_ROLE) REFERENCES AM_AI_ROLE (ID)
;

ALTER TABLE AM_GROUP_AIR ADD CONSTRAINT FK_AM_GAIR_AM_GROUP 
	FOREIGN KEY (FK_AM_GROUP) REFERENCES AM_GROUP (NAME)
;

ALTER TABLE AM_AI_ROLE ADD CONSTRAINT FK_AM_AIR_AM_APPLICATION_ITEM 
	FOREIGN KEY (FK_AM_APPLICATION_ITEM) REFERENCES AM_APPLICATION_ITEM (ID)
;

ALTER TABLE AM_AI_ROLE ADD CONSTRAINT FK_AM_AIR_AM_ROLE 
	FOREIGN KEY (FK_AM_ROLE) REFERENCES AM_ROLE (NAME)
;

ALTER TABLE AM_APPLICATION_ITEM ADD CONSTRAINT FK_AM_AI_AM_APPLICATION 
	FOREIGN KEY (FK_AM_APPLICATION) REFERENCES AM_APPLICATION (NAME)
;

ALTER TABLE AM_APPLICATION_ITEM ADD CONSTRAINT FK_AM_AI_AM_ITEM 
	FOREIGN KEY (FK_AM_ITEM) REFERENCES AM_ITEM (NAME)
;

ALTER TABLE AM_APPLICATION ADD CONSTRAINT FK_AM_APPLICATION_AM_COMUNE 
	FOREIGN KEY (FK_AM_COMUNE) REFERENCES AM_COMUNE (BELFIORE)
;

ALTER TABLE AM_GROUP ADD CONSTRAINT FK_AM_GROUP_AM_COMUNE 
	FOREIGN KEY (FK_AM_COMUNE) REFERENCES AM_COMUNE (BELFIORE)
;

ALTER TABLE AM_ANAGRAFICA ADD CONSTRAINT FK_AM_ANAGRAFICA_AM_USER 
	FOREIGN KEY (FK_AM_USER) REFERENCES AM_USER (NAME)
;